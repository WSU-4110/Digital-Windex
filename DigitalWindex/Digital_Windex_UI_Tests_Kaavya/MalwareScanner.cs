using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Digital_Windex_UI_Tests_Kaavya
{
    public enum ScanResult { NotFound, Success, Warning }

    public class MalwareScanner
    {
        private readonly IProcessRunner_Angelo _runner;
        public MalwareScanner(IProcessRunner_Angelo runner) => _runner = runner;

        public ScanResult Scan(string baseFolder)
        {
            string exe = Path.Combine(baseFolder, "McAfeeStingerPortable", "McAfeeStingerPortable.exe");
            if (!File.Exists(exe))
                return ScanResult.NotFound;

            int code = _runner.Run(exe, "").Result;
            return code == 0
              ? ScanResult.Success
              : ScanResult.Warning;
        }
    }
}
