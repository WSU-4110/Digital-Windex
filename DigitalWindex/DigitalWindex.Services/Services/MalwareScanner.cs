using DigitalWindex.Services;
using System.IO;
using System.Threading.Tasks;

namespace DigitalWindex.Services
{
    public enum ScanResult { NotFound, Success, Warning }

    public class MalwareScanner
    {
        private readonly IProcessRunner _runner;
        public MalwareScanner(IProcessRunner runner) => _runner = runner;

        public ScanResult Scan(string baseFolder)
        {
            string exe = Path.Combine(baseFolder, "McAfeeStingerPortable", "McAfeeStingerPortable.exe");
            if (!File.Exists(exe))
                return ScanResult.NotFound;

            int code = _runner.Run(exe, "").Result;
            return code == 0
              ? ScanResult.Success
              : ScanResult.Warning;
        }
    }
}
